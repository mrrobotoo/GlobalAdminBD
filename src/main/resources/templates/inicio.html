<!DOCTYPE html>
<html lang="en">

<head>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
		crossorigin="anonymous"></script>
	<title>Personas</title>
</head>

<body>
	<div th:include="navbar.html"></div> <!-- IMPORTAMOS EL NAVBAR -->

	<table class = "table">
		<thead>
			<tr>
				<th>Nombre</th>
				<th>Edad</th>
				<th>Sexo</th>
				<th></th>
				<th></th>
			</tr>
		</thead>
		<tbody>
			<tr th:each="item: ${listaPersonas}">
				<td th:text="${item.nombre}"></td>
				<td th:text="${item.edad}"></td>
				<td th:text="${item.sexo}"></td>
				<td>
					<a th:href="@{/eliminar/{id}(id=${item.id})}" class="btn btn-danger">ELIMINAR</a> 
				</td>
				<td>
					<div>
						<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modalContainer" th:attr="data-id=${item.id}">Actualizar</button> 
						<div class="modal fade" id="modalContainer" tabindex="-1" role="dialog" aria-labelledby="modalTitle" aria-hidden="true">
							<div class="modal-dialog" role="document">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" style="color: black;" id="modalTitle">ACTUALIZAR DATOS</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
											<form  th:action="@{/actualizar}" class="p-3 mb-2 bg-white text-black" method="post"> <!-- Se realiza un formulario para actualizar -->
												<input type="hidden" name="id" th:value="${item.id}"/> <!-- Se llama el  ID-->
												<table >
													<div class="mb-3">
														<label for="user-name" class="label label-pimary">NOMBRE </label>
														<input class="form-control" placeholder="Ingresa el nombre" type="text" name="nombre" >
													</div>
					
														
													<div class="mb-3">
														<label for="edad">EDAD </label>
														<input class="form-control" placeholder="Ingresa la edad" type="text" name="edad"/>
													</div>
					
													<div class="mb-3">
														<label for="sexo">Sexo: </label>
														<input class="form-control" placeholder="Ingresa el sexo" type="text" name="sexo" />
													</div>
					
													<tr>
														<td align="center"></td>
														<td style="padding-left: 0px; padding-top: 10px; padding-bottom: 10px;">
															<input type="submit" value="ACTUALIZAR" class="btn btn-primary" />
														</td>
													</tr>
												</table>
											</form>
									</div>
									<div class="modal-footer">
									</div>
								</div>
							</div>
						</div>
					</div>
				</td>
			</tr>
		</tbody>
	</table>

	<div th:include="footer.html"></div>

	<script>
		const openModalButtons = document.querySelectorAll('.btn-primary[data-bs-toggle="modal"]'); //Botones del modal.
		const modalContainer = document.querySelector('.modal-container'); //Se llama lo que tendra el modal agregado
		const closeModalButtons = document.querySelectorAll('.btn-close[data-bs-dismiss="modal"]'); // BotÃ³n de cerrar modal.

		openModalButtons.forEach((button) => { 
			button.addEventListener('click', () => { 
				const id = button.getAttribute('data-id'); //Se obtiene el ID.
				const form = document.querySelector('form'); //Se llama el formulario.
				form.action = `/actualizar/${id}`; //Se actualiza dependiendo del ID.
				form.reset(); 
				modalContainer.classList.add('show'); //Se abre la pantalla emergente al momento de seleccionar.
			});
		});

		closeModalButtons.forEach((button) => { 
			button.addEventListener('click', () => { 
				modalContainer.classList.remove('show'); //Cerrar modal
			});
		});
	</script>
</body>

</html>